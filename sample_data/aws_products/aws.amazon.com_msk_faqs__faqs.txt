General
Q: What is Amazon MSK?
Amazon Managed Streaming for Apache Kafka (Amazon MSK) is an AWS streaming data service that manages Apache Kafka infrastructure and operations, making it easy for developers and DevOps managers to run Apache Kafka applications and Kafka Connect connectors on AWS, without the need to become experts in operating Apache Kafka. Amazon MSK operates, maintains, and scales Apache Kafka clusters, provides enterprise-grade security features out of the box, and has built-in AWS integrations that accelerate development of streaming data applications. To get started, you can migrate existing Apache Kafka workloads and Kafka Connect connectors into Amazon MSK, or with a few clicks, you can build new ones from scratch. There are no data transfer charges for in-cluster traffic, and no commitments or upfront payments required. You only pay for the resources that you use.
Q: What is Apache Kafka?
Apache Kafka is an open-source, high performance, fault-tolerant, and scalable platform for building real-time streaming data pipelines and applications. Apache Kafka is a streaming data store that decouples applications producing streaming data (producers) into its data store from applications consuming streaming data (consumers) from its data store. Organizations use Apache Kafka as a data source for applications that continuously analyze and react to streaming data.
Learn more about Apache Kafka.
Q: What is Kafka Connect?
Kafka Connect, an open-source component of Apache Kafka, is a framework for connecting Apache Kafka with external systems, such as databases, key-value stores, search indexes, and file systems.
Q: What is streaming data?
Streaming data is a continuous stream of small records or events (a record or event is typically a few kilobytes) generated by thousands of machines, devices, websites, and applications. Streaming data includes a wide variety of data such as log files generated by customers using your mobile or web applications, ecommerce purchases, in-game player activity, information from social networks, financial trading floors, geospatial services, security logs, metrics, and telemetry from connected devices or instrumentation in data centers. Streaming data services like Amazon MSK and Amazon Kinesis Data Streams make it easy for you to continuously collect, process, and deliver streaming data.
Learn more about streaming data.
Q: What are Apache Kafka’s primary capabilities?
Apache Kafka has three key capabilities:
Apache Kafka stores streaming data in a fault-tolerant way, providing a buffer between producers and consumers. It stores events as a continuous series of records and preserves the order in which the records were produced.
Apache Kafka allows many data producers—e.g. websites, internet of things (IoT) devices, Amazon Elastic Compute Cloud (Amazon EC2) instances—to continuously publish streaming data and categorize it using Apache Kafka topics. Multiple data consumers (e.g. machine learning applications, AWS Lambda functions, or microservices) read from these topics at their own rate, similar to a message queue or enterprise messaging system.
Data consumers process data from Apache Kafka topics on a first-in-first-out basis, preserving the order data was produced.
Q: What are the key concepts of Apache Kafka?
Apache Kafka stores records in topics. Data producers write records to topics and consumers read records from topics. Each record in Apache Kafka consists of a key, a value, and a timestamp and sometimes header metadata. Apache Kafka partitions topics and replicates these partitions across multiple nodes called brokers. Apache Kafka runs as a cluster on one or more brokers, and brokers can be located in multiple AWS availability zones to create a highly available cluster. Apache Kafka relies on
Apache ZooKeeper to coordinate cluster tasks and can maintain state for resources interacting with an Apache Kafka cluster.
Q: When should I use Apache Kafka?
Apache Kafka supports real-time applications that transform, deliver, and react to streaming data, and can be used to build real-time streaming data pipelines that reliably send data between multiple systems or applications.
Q: What does Amazon MSK do?
Amazon MSK makes it easy to get started and run open-source versions of Apache Kafka on AWS with high availability and security. Amazon MSK also offers integrations with AWS services without the operational overhead of running an Apache Kafka cluster. Amazon MSK allows you to use open-source versions of Apache Kafka while the service manages the setup, provisioning, AWS integrations, and on-going maintenance of Apache Kafka clusters.
With a few clicks in the console, you can create an Amazon MSK cluster. From there, Amazon MSK replaces unhealthy brokers, automatically replicates data for high availability, manages Apache ZooKeeper nodes, automatically deploys hardware patches as needed, manages the integrations with AWS services, makes important metrics visible through the console, and supports Apache Kafka version upgrades so you can take advantage of improvements to the open-source version of Apache Kafka.
Q: What Apache Kafka versions does Amazon MSK support?
For supported Kafka versions, see the
Amazon MSK documentation.
Q: Are Apache Kafka APIs compatible with Amazon MSK?
Yes, all data plane and admin APIs are natively supported by Amazon MSK.
Q: Is the Apache Kafka AdminClient supported by Amazon MSK?
Yes.
Q: Does Amazon MSK support schema registration? Yes, Apache Kafka clients can use the AWS Glue Schema Registry, a serverless feature of AWS Glue, at no additional charge. Visit the Schema Registry
user documentation to get started and to learn more.
MSK Serverless (Preview)
Q: What is MSK Serverless? MSK Serverless is a cluster type for Amazon MSK that makes it easy for you to run Apache Kafka clusters without having to manage compute and storage capacity. With MSK Serverless, you can run your applications without having to provision, configure, or optimize clusters, and you pay for the data volume you stream and retain.
Q: Does MSK Serverless automatically balance partitions within a cluster? Yes. MSK Serverless fully manages partitions, including monitoring and moving them to even load across a cluster.
Q: How much data throughput capacity does MSK Serverless support? MSK Serverless provides up to 200 MBps of write capacity and 400 MBps of read capacity per cluster. Additionally, to ensure sufficient throughput availability for all partitions in a cluster, MSK Serverless allocates up to 5 MBps of instant write capacity and 10 MBps of instant read capacity per partition.
Q: What security features does MSK Serverless offer? MSK Serverless encrypts all traffic in transit and all data at rest using service-managed keys issued through AWS Key Management Service (KMS). Clients connect to MSK Serverless over a private connection using AWS PrivateLink without exposing your traffic to the public internet. Additionally, MSK Serverless offers IAM Access Control, which you can use to manage client authentication and client authorization to Apache Kafka resources such as topics.
Q: How can producers and consumers access my MSK Serverless clusters? When you create a MSK Serverless cluster, you provide subnets of one or more Amazon Virtual Private Clouds (VPCs) that host the clients of the cluster. Clients hosted in any of these VPCs will be able to connect to the MSK Serverless cluster using its broker bootstrap string.
Q: Which regions is MSK Serverless available in? Please refer to the MSK pricing page for up-to-date regional availability.
Data production and consumption
Q: Can I use Apache Kafka APIs to get data in and out of Apache Kafka?  Yes, Amazon MSK supports the native Apache Kafka producer and consumer APIs. Your application code does not need to change when clients begin to work with clusters within Amazon MSK.   Q: Can I use Apache Kafka Connect, Apache Kafka Streams, or any other ecosystem component of Apache Kafka with Amazon MSK?  Yes, you can use any component that leverages the Apache Kafka producer and consumer APIs, and the Apache Kafka Admin Client. Tools that upload .jar files into Apache Kafka clusters are currently not compatible with Amazon MSK, including Confluent Control Center, Confluent Auto Data Balancer, and Uber uReplicator.
Migrating to Amazon MSK
Q: Can I migrate data within my existing Apache Kafka cluster to Amazon MSK? Yes, you can use third-party tools or open-source tools like MirrorMaker, supported by Apache Kafka, to replicate data from clusters into an Amazon MSK cluster. Here is an Amazon
MSK migration lab to help you complete a migration.
Version upgrades
Q: Are Apache Kafka version upgrades supported?  Yes, Amazon MSK supports fully managed in-place Apache Kafka version upgrades for provisioned clusters. To learn more about upgrading your Apache Kafka version and high availability best practices, see the version upgrades documentation.
Clusters
Q: How do I create my first Amazon MSK cluster?
You can create your first cluster with a few clicks in the AWS management console or using the AWS SDKs. First, in the
Amazon MSK console select an AWS region to create an Amazon MSK cluster in. Choose a name for your cluster, the Virtual Private Cloud (VPC) you want to run the cluster with, and the subnets for each AZ. If you are creating a provisioned cluster, you will also be able to pick a broker instance type, quantity of brokers per AZ, and storage per broker.
Q: What resources are within a cluster?
Provisioned clusters contain broker instances, provisioned storage, and abstracted Apache ZooKeeper nodes. Serverless clusters are a resource in of themselves, which abstract away all underlying resources.
Q: What types of broker instances can I provision within an Amazon MSK cluster?
For provisioned clusters, you can choose EC2 T3.small or instances within the EC2 M5 instance family. For serverless clusters, brokers are completely abstracted.
Q: Does Amazon MSK offer Reserved Instance pricing?
No, not at this time.
Q: Do I need to provision and pay for broker boot volumes?
No, each broker you provision includes boot volume storage managed by the Amazon MSK service.
Q: When I create an Apache Kafka cluster, do the underlying resources (e.g. Amazon EC2 instances) show up in my EC2 console?
Some resources, like elastic network interfaces (ENIs), will show up in your Amazon EC2 account. Other Amazon MSK resources will not show up in your EC2 account as these are managed by the Amazon MSK service.
Q: What do I need to provision within an Amazon MSK cluster?
For provisioned clusters, you need to provision broker instances and broker storage with every cluster you create. You do not need to provision Apache ZooKeeper nodes as these resources are included at no additional charge with each cluster you create. For serverless clusters, you just create a cluster as a resource.
Q: What is the default broker configuration for a cluster?
Unless otherwise specified, Amazon MSK uses the same defaults specified by the open-source version of Apache Kafka. The default settings for both cluster types are documented
here.
Q: Can I provision brokers such that they are imbalanced across AZs (e.g. 3 in us-east-1a, 2 in us-east-1b, 1 in us-east-1c)?
No, Amazon MSK enforces the best practice of balancing broker quantities across AZs within a cluster.
Q: How does data replication work in Amazon MSK?
Amazon MSK uses Apache Kafka’s leader-follower replication to replicate data between brokers. Amazon MSK makes it easy to deploy clusters with multi-AZ replication and gives you the option to use a custom replication strategy by topic. By default with each of the replication options, leader and follower brokers will be deployed and isolated using the replication strategy specified. For example, if you select a three AZ broker replication strategy with 1 broker per AZ cluster, Amazon MSK will create a cluster of three brokers (one broker in three AZs in a region), and by default (unless you choose to override the topic replication factor) the topic replication factor will also be three.
Q: Can I change the default broker configurations or upload a cluster configuration to Amazon MSK? Yes, Amazon MSK allows you to create custom configurations and apply them to new and existing clusters. For more information on custom configurations, see the configuration documentation.
Q: What configuration properties am I able to customize? The configurations properties that you can customize are documented here.  Q: What is the default configuration of a new topic? Amazon MSK uses Apache Kafka’s default configuration unless otherwise specified here.
Topics
Q: How do I create topics?
Once your Apache Kafka cluster has been created, you can create topics using the Apache Kafka APIs. All topic and partition level actions and configurations are performed using Apache Kafka APIs. The following command is an example of creating a topic using Apache Kafka APIs and the configuration details available for your cluster:
bin/kafka-topics.sh --create —bootstrap-server <BootstrapBrokerString> --replication-factor 3 --partitions 1 --topic TopicName
Networking
Q: Does Amazon MSK run in an Amazon VPC?  Yes, Amazon MSK always runs within an Amazon VPC managed by the Amazon MSK service. Amazon MSK resources will be available to your own Amazon VPC, subnet, and security group you select when the cluster is setup. IP addresses from your VPC are attached to your Amazon MSK resources through elastic network interfaces (ENIs), and all network traffic stays within the AWS network and is not accessible to the internet by default.  Q: How will the brokers in my Amazon MSK cluster be made accessible to clients within my VPC? The brokers in your cluster will be made accessible to clients in your VPC through ENIs appearing in your account. The Security Groups on the ENIs will dictate the source and type of ingress and egress traffic allowed on your brokers.
Q: Is it possible to connect to my cluster over the public Internet? Yes, Amazon MSK offers an option to securely connect to the brokers of Amazon MSK clusters running Apache Kafka 2.6.0 or later versions over the internet. By enabling public access, authorized clients external to a private Amazon Virtual Private Cloud (VPC) can stream encrypted data in and out of specific Amazon MSK clusters. You can enable public access for MSK clusters after a cluster has been created at no additional cost, but standard AWS data transfer costs for cluster ingress and egress apply. To learn more about turning on public access, see the public access documentation.
Q: Is the connection between my clients and an Amazon MSK cluster private? By default, the only way data can be produced and consumed from an Amazon MSK cluster is over a private connection between your clients in your VPC and the Amazon MSK cluster. However, if you turn on public access for your Amazon MSK cluster and connect to your MSK cluster using the public bootstrap-brokers string, the connection, though authenticated, authorized and encrypted, is no longer considered private. We recommend that you configure the cluster's security groups to have inbound TCP rules that allow public access from your trusted IP address and make these rules as restrictive as possible if you turn on public access.
Connecting to the VPC
Q: How do I connect to my Amazon MSK cluster outside of the VPC?
There are several methods to connect to your Amazon MSK clusters outside of your VPC. The easiest way is to turn on public connectivity over the internet to the brokers of MSK clusters running Apache Kafka 2.6.0 or later versions. For security reasons, you can't turn on public access while creating an MSK cluster. However, you can update an existing cluster to make it publicly accessible. You can also create a new cluster and then update it to make it publicly accessible. To learn more about turning on public access, see the public access documentation. If you want to connect to your MSK cluster from inside AWS network but outside the cluster’s Amazon VPC, you can use VPC Peering, AWS Direct Connect, AWS Transit Gateway, VPN or a REST Proxy. To learn more about setting up these options, see Access from within AWS documentation.
Encryption
Q: Can I encrypt data in my Amazon MSK cluster?  Yes, Amazon MSK uses Amazon Elastic Block Store (Amazon EBS) server-side encryption and AWS Key Management Service (AWS KMS) keys to encrypt storage volumes.
Q: Is data encrypted in transit between brokers within an Amazon MSK cluster?  Yes, by default new clusters have encryption in-transit enabled via TLS for inter-broker communication. For provisioned clusters, you can opt out of using encryption in transit when a cluster is created.
Q: Is data encrypted in transit between my Apache Kafka clients and the Amazon MSK service?  Yes, by default in-transit encryption is set to TLS only for clusters created from the CLI or AWS Management Console. Additional configuration is required for clients to communicate with clusters using TLS encryption. For provisioned clusters, you can change the default encryption setting by selecting the TLS/plaintext or plaintext settings. Read more about MSK Encryption.
Q: Is data encrypted in transit as it moves between brokers and Apache ZooKeeper nodes in an Amazon MSK cluster?  Yes, Amazon MSK clusters running Apache Kafka version 2.5.1 or greater support TLS in-transit encryption between Kafka brokers and ZooKeeper nodes.
Access Management
Q: How do I control cluster authentication and Apache Kafka API authorization? For serverless clusters, you can use IAM Access Control for both authentication and authorization. For provisioned clusters, you have three options: 1) AWS Identity and Access Management (IAM) Access Control for both AuthN/Z (recommended), 2) TLS certificate authentication (CA) for AuthN and access control lists for AuthZ, and 3) SASL/SCRAM for AuthN and access control lists for AuthZ. Amazon MSK recommends using IAM Access Control. It is the easiest to use and, because it defaults to least privilege access, the most secure option.
Q: How does authorization work in Amazon MSK? If you are using IAM Access Control, Amazon MSK uses the policies you write and its own authorizer to authorize actions. If you are using TLS certificate authentication or SASL/SCRAM, Apache Kafka uses access control lists (ACLs) for authorization. To enable ACLs you must enable client authentication using either TLS certificates or SASL/SCRAM.
Q: How can I authenticate and authorize a client at the same time? If you are using IAM Access Control, Amazon MSK will authenticate and authorize for you without any additional set up. If you are using TLS authentication, you can use the Dname of clients TLS certificates as the principal of the ACL to authorize client requests. If you are using SASL/SCRAM, you can use the username as the principal of the ACL to authorize client requests.
Q: How do I control service API actions? You can control service API actions using AWS Identity and Access Management (IAM).
Q: Can I enable IAM Access Control for an existing cluster? Yes, you can enable IAM Access Control for an existing cluster from the AWS console or by using the UpdateSecurity API.
Q: Can I use IAM Access Control outside of Amazon MSK? No, IAM Access Control is only available for Amazon MSK clusters.
Monitoring, metrics, logging, and tagging
Q: How do I monitor the performance of my clusters or topics?
You can monitor the performance of your clusters using the Amazon MSK console, Amazon CloudWatch console, or via JMX and host metrics using Open Monitoring with Prometheus, an open-source monitoring solution.
Q: What is the cost for the different CloudWatch monitoring levels?
The cost of monitoring your cluster using Amazon CloudWatch is dependent on the monitoring level and the size of your Apache Kafka cluster. Amazon CloudWatch charges per metric per month and includes a free tier; see
Amazon CloudWatch pricing for more information. For details on the number of metrics exposed for each monitoring level, see
Amazon MSK monitoring documentation.
Q: What monitoring tools are compatible with Open Monitoring with Prometheus?
Tools that are designed to read from
Prometheus exporters are compatible with Open Monitoring, like:
Datadog,
Lenses,
New Relic,
Sumo Logic, or a Prometheus server. For details on Open Monitoring, see
Amazon MSK Open Monitoring documentation.
Q: How do I monitor the health and performance of clients?
You can use any client-side monitoring supported by the Apache Kafka version you are using.
Q: Can I tag Amazon MSK resources?
Yes, you can tag Amazon MSK clusters from the AWS Command Line Interface (AWS CLI) or Console.
Q: How do I monitor consumer lag?
Topic-level consumer lag metrics are available as part of the default set of metrics that Amazon MSK publishes to Amazon CloudWatch for all clusters. No additional setup is required to get these metrics. For provisioned clusters, you can also get partition-level consumer lag metrics (partition dimension). To do so, enable enhanced monitoring (PER_PARTITION_PER_TOPIC) on your cluster. Alternatively, you can enable Open Monitoring on your cluster, and use a Prometheus server, to capture partition level metrics from the brokers in your cluster. Consumer lag metrics are available at port 11001, just as other Kafka metrics.
Q: How much does it cost to publish the consumer lag metric to Amazon CloudWatch?
Topic level metrics are included in the default set of Amazon MSK metrics, which are free of charge. Partition level metrics are charged as per Amazon CloudWatch pricing.
Q: How do I access Apache Kafka broker Logs?
You can enable broker log delivery for provisioned clusters. You can deliver broker logs to Amazon CloudWatch Logs, Amazon Simple Storage Service (S3), and Amazon Kinesis Data Firehose. Kinesis Data Firehose supports Amazon OpenSearch Service among other destinations. To learn how to enable this feature, see the Amazon MSK
Logging Documentation. To learn about pricing, refer to
CloudWatch Logs and
Kinesis Data Firehose pricing pages.
Q: What is the logging level for broker logs?
Amazon MSK provides INFO level logs for all brokers within a provisioned cluster.
Q: How do I access Apache ZooKeeper Logs?
You can request Apache ZooKeeper logs through a support ticket.
Q: Can I log the use of Apache Kafka resource APIs, like create topic?
Yes, if you use IAM Access Control, the use of Apache Kafka resource APIs is logged to AWS CloudTrail.
Apache ZooKeeper
Q: What is Apache ZooKeeper?  From https://zookeeper.apache.org: “Apache ZooKeeper is a centralized service for maintaining configuration information, naming, providing distributed synchronization, and providing group services. All of these kinds of services are used in some form or another by distributed applications,” including Apache Kafka.
Q: Does Amazon MSK use Apache ZooKeeper?  Yes, Amazon MSK uses Apache ZooKeeper and manages Apache ZooKeeper within each cluster as a part of the Amazon MSK service. Apache ZooKeeper nodes are included with each cluster at no additional cost.
Integrations
Q: What AWS services does Amazon MSK integrate with?
Amazon MSK integrates with:
Amazon Virtual Private Cloud (Amazon VPC) for network isolation and security
Amazon CloudWatch for metrics
AWS Key Management Service (AWS KMS) for storage volume encryption
Amazon IAM for authentication and authorization of Apache Kafka and service APIs
AWS Lambda for MSK event sourcing
AWS IoT for IoT event sourcing
AWS Glue Schema Registry for controlling the evolution of schemas used by Apache Kafka applications
AWS CloudTrail for AWS API logs
AWS Certificate Manager for Private CAs used for client TLS authentication
AWS CloudFormation for describing and provisioning Amazon MSK clusters using code
Amazon Kinesis Data Analytics for fully managed Apache Flink applications that process streaming data
Amazon Kinesis Data Analytics Studio for interactive streaming SQL on Apache Kafka
AWS Secrets Manager for client credentials used for SASL/SCRAM authentication
Amazon MSK Serverless integrates with:
Amazon VPC for network isolation and security
AWS PrivateLink for private connectivity
Scaling
Q: How can I scale up storage in my cluster?
You can scale up storage in your provisioned clusters using the AWS Management Console or the AWS CLI. In serverless clusters, storage is scaled seamlessly based on your usage.
Q: How can I automatically expand storage in my cluster?
You can create an auto-scaling storage policy using the AWS Management Console or by creating an AWS Application Auto Scaling policy using the AWS CLI or APIs.
Q: Can I scale the number of brokers in an existing cluster?
Yes. You can scale out, or increase, the number of brokers for provisioned Amazon MSK clusters.
Q: Can I scale the broker size in an existing cluster?
Yes. You can choose to scale to a smaller or larger broker type on your provisioned Amazon MSK clusters.
Q: How do I balance partitions across brokers?
You can use Cruise Control for automatically rebalancing partitions to manage I/O heat. See the
Cruise Control documentation for more information. Alternatively, you can use the Kafka Admin API kafka-reassign-partitions.sh to reassign partitions across brokers. In serverless clusters, Amazon MSK automatically balances partitions.
Pricing and availability
Q: How does Amazon MSK pricing work?  Pricing depends on the resources you create. You can learn more by visiting our pricing page.
Q: Do I pay for data transfer as a result of data replication?  No, all in-cluster data transfer is included with the service at no additional charge.  Q: What AWS regions offer Amazon MSK?  Amazon MSK region availability is documented here.
Q: How does data transfer pricing work?  With provisioned clusters, you will pay standard AWS data transfer charges for data transferred in and out of an Amazon MSK cluster. You will not be charged for data transfer within the cluster in a region, including data transfer between brokers and data transfer between brokers and Apache ZooKeeper nodes.
With serverless clusters, you will pay standard AWS data transfer charges for data transferred to or from another region and for data transferred out to the public internet.
Compliance
Q: What compliance programs are in scope for Amazon MSK?
Amazon MSK is compliant or eligible for the following programs:
HIPAA eligible
PCI
ISO
SOC 1,2,3
For a complete list of AWS services and compliance programs, please see AWS Services in Scope by Compliance Program.
Service Level Agreement
Q: What does the Amazon MSK SLA guarantee?
Our Amazon MSK SLA guarantees a Monthly Uptime Percentage of at least 99.9% for Amazon MSK (not applicable to MSK Serverless).
Q: How do I know if I qualify for a SLA Service Credit?
You are eligible for a SLA credit for Amazon MSK under the Amazon MSK SLA if Multi-AZ deployments on Amazon MSK have a Monthly Uptime Percentage of less than 99.9% during any monthly billing cycle.
For full details on all of the terms and conditions of the SLA, as well as details on how to submit a claim, please see the
Amazon MSK SLA details page.
Get started with Amazon MSK
Calculate your costs
Visit the Amazon MSK pricing page.
Review the Get Started guide
Learn how to set up your Apache Kafka cluster on Amazon MSK in this step-by-step guide.
Run your Apache Kafka cluster
Start running your Apache Kafka cluster on Amazon MSK. Log in to the Amazon MSK console.
Amazon MSK FAQs